{"ast":null,"code":"import _regeneratorRuntime from\"C:/Projects/StrangersThings/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Projects/StrangersThings/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Projects/StrangersThings/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{Link,useHistory}from'react-router-dom';import{callApi}from'../api';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Register=function Register(_ref){var setToken=_ref.setToken,action=_ref.action;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var isLogin=action==='login';var title=isLogin?'Login':'Register';var oppositeAction=isLogin?'register':'login';var oppositeTitle=isLogin?'Register':'Login';var history=useHistory();var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var data,token;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();_context.next=3;return callApi({url:\"users/\".concat(action),body:{user:{username:username,password:password}},method:'POST'});case 3:data=_context.sent;_context.prev=4;token=data.data.token;if(!token){_context.next=11;break;}localStorage.setItem('st-token',token);setToken(token);history.push('/');return _context.abrupt(\"return\",token);case 11:_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](4);window.alert(\"Wrong Username or Password!\");case 16:case\"end\":return _context.stop();}}},_callee,null,[[4,13]]);}));return function handleSubmit(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h2\",{children:title}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"username\",required:true,value:username,onChange:function onChange(event){return setUsername(event.target.value);}}),/*#__PURE__*/_jsxs(\"div\",{id:\"TextField\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"password\",value:password,onChange:function onChange(event){return setPassword(event.target.value);}}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:title})]})]}),/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(Link,{to:\"/\".concat(oppositeAction),children:oppositeTitle})}),/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(Link,{to:\"/\",children:\"Home\"})})]});};export default Register;","map":{"version":3,"sources":["C:/Projects/StrangersThings/src/components/Register.js"],"names":["React","useState","Link","useHistory","callApi","Register","setToken","action","username","setUsername","password","setPassword","isLogin","title","oppositeAction","oppositeTitle","history","handleSubmit","event","preventDefault","url","body","user","method","data","token","localStorage","setItem","push","window","alert","target","value"],"mappings":"mbAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,OAASC,IAAT,CAAeC,UAAf,KAAiC,kBAAjC,CACA,OAASC,OAAT,KAAwB,QAAxB,C,6IAEA,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,MAA0B,IAAvBC,CAAAA,QAAuB,MAAvBA,QAAuB,CAAbC,MAAa,MAAbA,MAAa,CACvC,cAAgCN,QAAQ,CAAC,EAAD,CAAxC,wCAAOO,QAAP,eAAiBC,WAAjB,eACA,eAAgCR,QAAQ,CAAC,EAAD,CAAxC,yCAAOS,QAAP,eAAiBC,WAAjB,eACA,GAAMC,CAAAA,OAAO,CAAGL,MAAM,GAAK,OAA3B,CACA,GAAMM,CAAAA,KAAK,CAAGD,OAAO,CAAG,OAAH,CAAa,UAAlC,CACA,GAAME,CAAAA,cAAc,CAAGF,OAAO,CAAG,UAAH,CAAgB,OAA9C,CACA,GAAMG,CAAAA,aAAa,CAAGH,OAAO,CAAG,UAAH,CAAgB,OAA7C,CACA,GAAMI,CAAAA,OAAO,CAAGb,UAAU,EAA1B,CAEA,GAAMc,CAAAA,YAAY,2FAAG,iBAAOC,KAAP,iIACjBA,KAAK,CAACC,cAAN,GADiB,sBAGEf,CAAAA,OAAO,CAAC,CACvBgB,GAAG,iBAAWb,MAAX,CADoB,CAEvBc,IAAI,CAAE,CAAEC,IAAI,CAAE,CAAEd,QAAQ,CAARA,QAAF,CAAYE,QAAQ,CAARA,QAAZ,CAAR,CAFiB,CAGvBa,MAAM,CAAE,MAHe,CAAD,CAHT,QAGXC,IAHW,+BAadC,KAAK,CAAGD,IAAI,CAACA,IAAL,CAAUC,KAAlB,CAbc,IAcVA,KAdU,0BAeVC,YAAY,CAACC,OAAb,CAAsB,UAAtB,CAAkCF,KAAlC,EACAnB,QAAQ,CAACmB,KAAD,CAAR,CACAT,OAAO,CAACY,IAAR,CAAa,GAAb,EAjBU,gCAkBHH,KAlBG,2FAqBdI,MAAM,CAACC,KAAP,CAAa,6BAAb,EArBc,qEAAH,kBAAZb,CAAAA,YAAY,6CAAlB,CA4BA,mBACI,wCACI,oBAAKJ,KAAL,EADJ,cAEI,cAAM,QAAQ,CAAEI,YAAhB,wBACI,cACI,IAAI,CAAC,MADT,CAEI,WAAW,CAAC,UAFhB,CAGI,QAAQ,KAHZ,CAII,KAAK,CAAET,QAJX,CAKI,QAAQ,CAAE,kBAACU,KAAD,QAAWT,CAAAA,WAAW,CAACS,KAAK,CAACa,MAAN,CAAaC,KAAd,CAAtB,EALd,EADJ,cAQI,aAAK,EAAE,CAAE,WAAT,wBACA,cACI,IAAI,CAAC,UADT,CAEI,WAAW,CAAC,UAFhB,CAGI,KAAK,CAAEtB,QAHX,CAII,QAAQ,CAAE,kBAACQ,KAAD,QAAWP,CAAAA,WAAW,CAACO,KAAK,CAACa,MAAN,CAAaC,KAAd,CAAtB,EAJd,EADA,cAOA,eAAQ,IAAI,CAAC,QAAb,UAAuBnB,KAAvB,EAPA,GARJ,GAFJ,cAoBI,qCACI,KAAC,IAAD,EAAM,EAAE,YAAMC,cAAN,CAAR,UAAiCC,aAAjC,EADJ,EApBJ,cAuBI,qCACI,KAAC,IAAD,EAAM,EAAE,CAAC,GAAT,kBADJ,EAvBJ,GADJ,CA8BH,CAnED,CAsEA,cAAeV,CAAAA,QAAf","sourcesContent":["import React, { useState } from 'react';\r\nimport { Link, useHistory } from 'react-router-dom';\r\nimport { callApi } from '../api';\r\n\r\nconst Register = ({ setToken, action }) => {\r\n    const [username, setUsername] = useState('');\r\n    const [password, setPassword] = useState('');\r\n    const isLogin = action === 'login';\r\n    const title = isLogin ? 'Login' : 'Register';\r\n    const oppositeAction = isLogin ? 'register' : 'login';\r\n    const oppositeTitle = isLogin ? 'Register' : 'Login';\r\n    const history = useHistory();\r\n\r\n    const handleSubmit = async (event) => {\r\n        event.preventDefault();\r\n\r\n        const data = await callApi({\r\n            url: `users/${action}`,\r\n            body: { user: { username, password } },\r\n            method: 'POST',\r\n        });\r\n\r\n\r\n        let token\r\n\r\n        try { \r\n           token = data.data.token\r\n           if (token) {\r\n               localStorage.setItem( 'st-token', token );\r\n               setToken(token);\r\n               history.push('/');\r\n               return token\r\n           } \r\n       } catch (error) {\r\n           window.alert(\"Wrong Username or Password!\")\r\n       }\r\n   \r\n        \r\n    };\r\n\r\n\r\n    return (\r\n        <>\r\n            <h2>{title}</h2>\r\n            <form onSubmit={handleSubmit}>\r\n                <input\r\n                    type=\"text\"\r\n                    placeholder=\"username\"\r\n                    required\r\n                    value={username}\r\n                    onChange={(event) => setUsername(event.target.value)}\r\n                ></input>\r\n                <div id =\"TextField\">\r\n                <input\r\n                    type=\"password\"\r\n                    placeholder=\"password\"\r\n                    value={password}\r\n                    onChange={(event) => setPassword(event.target.value)}\r\n                ></input>\r\n                <button type=\"submit\">{title}</button>\r\n                </div>\r\n            </form>\r\n            <button>\r\n                <Link to={`/${oppositeAction}`}>{oppositeTitle}</Link>\r\n            </button>\r\n            <button>\r\n                <Link to=\"/\">Home</Link>\r\n            </button>\r\n            \r\n        </>\r\n    );\r\n};\r\n\r\n\r\nexport default Register;"]},"metadata":{},"sourceType":"module"}