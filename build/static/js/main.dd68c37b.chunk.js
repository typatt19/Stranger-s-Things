(this.webpackJsonpStrangersThings=this.webpackJsonpStrangersThings||[]).push([[0],{31:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n(18),s=n.n(c),o=n(5),a=n(3),i=n(2),u=n.n(i),l=n(7),j=n(4),b="https://strangers-things.herokuapp.com/api/2104-ECE-RM-WEB-PT/",d=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r,c,s,o,a,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.url,r=t.method,c=t.token,s=t.body,console.log("callApi: ",{url:n,method:r,token:c,body:s}),e.prev=2,o={method:r?r.toUpperCase():"GET",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)},c&&(o.headers.Authorization="Bearer ".concat(c)),console.log("request URL: ",b+n),e.next=8,fetch(b+n,o);case 8:return a=e.sent,console.log(a),e.next=12,a.json();case 12:if(i=e.sent,console.log("data: ",i),!i.error){e.next=16;break}throw i.error;case 16:return e.abrupt("return",i);case 19:e.prev=19,e.t0=e.catch(2),console.error("ERROR: ",e.t0);case 22:case"end":return e.stop()}}),e,null,[[2,19]])})));return function(t){return e.apply(this,arguments)}}(),p=n(0),h=function(e){var t=e.token,n=e.postID,c=Object(r.useState)(""),s=Object(a.a)(c,2),o=s[0],i=s[1],j=function(){var e=Object(l.a)(u.a.mark((function e(r){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.next=3,d({url:"posts/".concat(n,"/messages"),method:"POST",body:{message:{content:o}},token:t});case 3:e.sent,i("");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("form",{onSubmit:j,children:[Object(p.jsx)("input",{type:"text",placeholder:"Type Message Here",required:!0,value:o,onChange:function(e){return i(e.target.value)}}),Object(p.jsx)("button",{type:"submit",children:"Send Message"})]})})},O=function(e){var t,n=e.posts,r=e.post,c=e.token,s=Object(j.f)().postId,a=Object(j.e)();if(0===n.length)return null;t=r||n.find((function(e){return s===e._id}));var i=function(){var e=Object(l.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,d({url:"/posts/".concat(t._id),method:"DELETE",token:c});case 3:e.sent,a.push("/posts"),window.location.reload();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return console.log("post",t),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h2",{children:Object(p.jsx)("u",{children:t.title})}),t.author.username?Object(p.jsxs)("div",{children:[Object(p.jsx)("b",{style:{fontSize:"23px"},children:"Submitted by:"})," ",t.author.username]}):null,Object(p.jsxs)("div",{children:[Object(p.jsx)("b",{style:{fontSize:"23px"},children:"Description:"})," ",t.description]}),Object(p.jsxs)("div",{children:[Object(p.jsx)("b",{style:{fontSize:"23px"},children:"Price:"})," ",t.price]}),Object(p.jsxs)("div",{children:[Object(p.jsx)("b",{style:{fontSize:"23px"},children:"Location:"})," ",t.location]}),Object(p.jsxs)("div",{children:[Object(p.jsx)("b",{style:{fontSize:"23px"},children:"Delivers:"})," ",t.willDeliver?"Yes":"No"]}),r?null:Object(p.jsx)(o.b,{to:"/posts",children:"Back to all posts"}),t.isAuthor?Object(p.jsxs)(p.Fragment,{children:[t.messages.map((function(e){return Object(p.jsxs)("div",{children:[Object(p.jsxs)("div",{children:[Object(p.jsx)("b",{style:{fontSize:"23px"},children:"Sender:"})," ",e.fromUser.username," "]}),Object(p.jsxs)("div",{children:[Object(p.jsx)("b",{style:{fontSize:"23px"},children:"Message:"})," ",e.content]})]})})),Object(p.jsx)("button",{children:Object(p.jsx)(o.b,{to:"/EditPost/"+t._id,children:"Edit Post"})}),Object(p.jsx)("button",{onClick:i,children:"Delete Post"})]}):Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(h,{postID:t._id,token:c})})]})},x={searchContainer:{display:"flex",justifyContent:"center",padding:"16px",alignItems:"center"},searchInput:{margin:"0 16px"}},f=function(e){var t=e.posts,n=Object(r.useState)(""),c=Object(a.a)(n,2),s=c[0],i=c[1],u=s.length>0?t.filter((function(e){return function(e,t){for(var n=t.toLowerCase(),r=0,c=[e.description,e.location,e.title,e.author.username,e.price];r<c.length;r++)if(c[r].toLowerCase().includes(n))return!0;return!1}(e,s)})):t;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("b",{style:{fontSize:"28px"},children:Object(p.jsx)("h2",{children:"Posts"})}),Object(p.jsx)("div",{style:x.searchContainer,children:Object(p.jsx)("input",{type:"text",placeholder:"Search Post",style:x.searchInput,value:s,onChange:function(e){i(e.target.value)}})}),u.map((function(e){return Object(p.jsxs)("div",{style:{border:"1px solid black"},children:[Object(p.jsx)(O,{posts:t,post:e}),Object(p.jsx)("button",{children:Object(p.jsx)(o.b,{to:"/posts/".concat(e._id),children:"View Post"})})]},e._id)}))]})},g=function(e){var t=e.token,n=Object(j.e)(),c=Object(r.useState)(""),s=Object(a.a)(c,2),i=s[0],b=s[1],h=Object(r.useState)(""),O=Object(a.a)(h,2),x=O[0],f=O[1],g=Object(r.useState)(""),v=Object(a.a)(g,2),m=v[0],y=v[1],k=Object(r.useState)("On Request"),w=Object(a.a)(k,2),S=w[0],C=w[1],P=Object(r.useState)(!1),T=Object(a.a)(P,2),D=T[0],E=T[1],F=function(){var e=Object(l.a)(u.a.mark((function e(r){var c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.next=3,d({url:"/posts",method:"POST",body:{post:{title:i,description:x,price:m,location:S,willDeliver:D}},token:t});case 3:c=e.sent,n.push("/posts"),window.location.reload(),console.log(c);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h2",{children:"Create New Post"}),Object(p.jsxs)("form",{onSubmit:F,children:[Object(p.jsxs)("div",{id:"TextField",children:[Object(p.jsx)("input",{type:"text",placeholder:"Title",value:i,onChange:function(e){return b(e.target.value)}}),Object(p.jsx)("input",{type:"text",placeholder:"Description",value:x,onChange:function(e){return f(e.target.value)}}),Object(p.jsx)("input",{type:"text",placeholder:"Price",value:m,onChange:function(e){return y(e.target.value)}}),Object(p.jsx)("input",{type:"text",placeholder:"Location",value:S,onChange:function(e){return C(e.target.value)}}),Object(p.jsx)("input",{type:"checkbox",value:D,onChange:function(e){return E(e.target.value)}})]}),Object(p.jsx)("button",{type:"submit",children:"Post!"})]}),Object(p.jsx)("button",{children:Object(p.jsx)(o.b,{to:"/",children:"Home"})})]})},v=function(e){var t=e.token,n=e.posts,c=Object(j.e)(),s=Object(j.f)().postId;if(0===n.length)return null;var i=n.find((function(e){return s===e._id}));console.log("EditPosts",n),console.log("EditPosts",s);var b=Object(r.useState)(i.title),h=Object(a.a)(b,2),O=h[0],x=h[1],f=Object(r.useState)(i.description),g=Object(a.a)(f,2),v=g[0],m=g[1],y=Object(r.useState)(i.price),k=Object(a.a)(y,2),w=k[0],S=k[1],C=Object(r.useState)(i.location),P=Object(a.a)(C,2),T=P[0],D=P[1],E=Object(r.useState)(i.willDeliver),F=Object(a.a)(E,2),I=F[0],L=F[1],_=function(){var e=Object(l.a)(u.a.mark((function e(n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,d({url:"/posts/".concat(i._id),method:"PATCH",body:{post:{title:O,description:v,price:w,location:T,willDeliver:I}},token:t});case 3:r=e.sent,c.push("/posts"),window.location.reload(),console.log(r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h2",{children:"Edit Post"}),Object(p.jsxs)("form",{onSubmit:_,children:[Object(p.jsxs)("div",{id:"TextField",children:[Object(p.jsx)("input",{type:"text",placeholder:"Title",value:O,onChange:function(e){return x(e.target.value)}}),Object(p.jsx)("input",{type:"text",placeholder:"Description",value:v,onChange:function(e){return m(e.target.value)}}),Object(p.jsx)("input",{type:"text",placeholder:"Price",value:w,onChange:function(e){return S(e.target.value)}}),Object(p.jsx)("input",{type:"text",placeholder:"Location",value:T,onChange:function(e){return D(e.target.value)}}),Object(p.jsx)("input",{type:"checkbox",value:I,onChange:function(e){return L(e.target.value)}})]}),Object(p.jsx)("button",{type:"submit",children:"Sumbit Edit"})]}),Object(p.jsx)("button",{children:Object(p.jsx)(o.b,{to:"/",children:"Home"})})]})},m=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d({url:"/users/me",token:t});case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d({url:"/posts",token:t});case 2:return n=e.sent,r=n.data.posts,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(r.useState)(""),t=Object(a.a)(e,2),n=t[0],c=t[1],s=Object(r.useState)({}),i=Object(a.a)(s,2),b=i[0],d=i[1],h=Object(r.useState)([]),x=Object(a.a)(h,2),k=x[0],S=x[1],C=void 0!==b.username,P=function(){localStorage.removeItem("st-token"),c(""),d({})};return Object(r.useEffect)(Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==k.length){e.next=5;break}return e.next=3,y(n);case 3:t=e.sent,S(t);case 5:case"end":return e.stop()}}),e)})))),Object(r.useEffect)(Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=3;break}return c(localStorage.getItem("st-token")),e.abrupt("return");case 3:return e.next=5,m(n);case 5:t=e.sent,d(t);case 7:case"end":return e.stop()}}),e)}))),[n]),console.log("userData",b),console.log("isLoggedIn",C),Object(p.jsxs)(p.Fragment,{children:[C?"":Object(p.jsxs)("h1",{children:["Welcome! ",Object(p.jsx)("br",{}),"Please ",Object(p.jsx)("a",{href:"/login",children:" sign in"})," or ",Object(p.jsx)("a",{href:"/register",children:"create an account"}),"."]}),Object(p.jsxs)(j.a,{exact:!0,path:"/",children:[C?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("div",{id:"Greeting",children:["Hello, ",b.username]}),Object(p.jsx)("button",{onClick:P,children:"Log Out"}),Object(p.jsx)("button",{children:Object(p.jsx)(o.b,{to:"/CreatePost",children:"Create A New Post"})})]}):Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("button",{children:Object(p.jsx)(o.b,{to:"/register",children:"Register"})}),Object(p.jsx)("button",{children:Object(p.jsx)(o.b,{to:"/login",children:"Login"})})]}),Object(p.jsx)("button",{children:Object(p.jsx)(o.b,{to:"/posts",children:"View All Posts"})}),C?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h1",{children:"My Messages"}),b.messages.map((function(e){return e.fromUser._id===b._id?Object(p.jsxs)("div",{children:[Object(p.jsxs)("div",{children:["Sender: ",e.fromUser.username," "]}),Object(p.jsxs)("div",{children:["Message: ",e.content]})]},e._id):null}))]}):null,C?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h1",{children:"My Posts"}),b.posts.map((function(e){return Object(p.jsx)(O,{post:e,token:n,posts:k})}))]}):null]}),Object(p.jsxs)(j.a,{exact:!0,path:"/posts",children:[Object(p.jsxs)("button",{children:[" ",Object(p.jsx)(o.b,{to:"/",children:"Home"})]}),Object(p.jsxs)("button",{children:[" ",Object(p.jsx)(o.b,{to:"/CreatePost",children:"Create New Post"})]}),C?Object(p.jsx)("button",{onClick:P,children:"Log Out"}):null,Object(p.jsx)("h1",{children:"Below are all recent posts"}),Object(p.jsx)(f,{posts:k,token:n})]}),Object(p.jsx)(j.a,{path:"/posts/:postId",children:Object(p.jsx)(O,{posts:k})}),Object(p.jsx)(j.a,{path:"/register",children:Object(p.jsx)(w,{action:"register",setToken:c})}),Object(p.jsx)(j.a,{path:"/login",children:Object(p.jsx)(w,{action:"login",setToken:c})}),Object(p.jsx)(j.a,{path:"/CreatePost",children:Object(p.jsx)(g,{action:"post",token:n})}),Object(p.jsx)(j.a,{path:"/EditPost/:postId",children:Object(p.jsx)(v,{posts:k,token:n})})]})},w=function(e){var t=e.setToken,n=e.action,c=Object(r.useState)(""),s=Object(a.a)(c,2),i=s[0],b=s[1],h=Object(r.useState)(""),O=Object(a.a)(h,2),x=O[0],f=O[1],g="login"===n,v=g?"Login":"Register",m=g?"register":"login",y=g?"Register":"Login",k=Object(j.e)(),w=function(){var e=Object(l.a)(u.a.mark((function e(r){var c,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.next=3,d({url:"users/".concat(n),body:{user:{username:i,password:x}},method:"POST"});case 3:if(c=e.sent,e.prev=4,!(s=c.data.token)){e.next=11;break}return localStorage.setItem("st-token",s),t(s),k.push("/"),e.abrupt("return",s);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),window.alert("Wrong Username or Password!");case 16:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h2",{children:v}),Object(p.jsxs)("form",{onSubmit:w,children:[Object(p.jsx)("input",{type:"text",placeholder:"username",required:!0,value:i,onChange:function(e){return b(e.target.value)}}),Object(p.jsxs)("div",{id:"TextField",children:[Object(p.jsx)("input",{type:"password",placeholder:"password",value:x,onChange:function(e){return f(e.target.value)}}),Object(p.jsx)("button",{type:"submit",children:v})]})]}),Object(p.jsx)("button",{children:Object(p.jsx)(o.b,{to:"/".concat(m),children:y})}),Object(p.jsx)("button",{children:Object(p.jsx)(o.b,{to:"/",children:"Home"})})]})};s.a.render(Object(p.jsx)(o.a,{children:Object(p.jsx)(k,{})}),document.querySelector("#app"))}},[[31,1,2]]]);
//# sourceMappingURL=main.dd68c37b.chunk.js.map